% loop through each depth
for iz=1:nz
    % compute k1-6
    [k1_dN, k1_dP, k1_dZ] = tau*dNPZdt(Nute(iz), Phyt(iz), Zoo(iz), ...
                                zvec(iz),Vm, Ks, Kext,Rm, Lambda, gamma, m, g);
    [k2_dN, k2_dP, k2_dZ] = tau*dNPZdt(Nute(iz)+k1_dN/4,...
                                       Phyt(iz)+k1_dP/4,...
                                       Zoo(iz)+k1_dZ/4, ...
                                zvec(iz),Vm, Ks, Kext,Rm, Lambda, gamma, m, g);
    [k3_dN, k3_dP, k3_dZ] = tau*dNPZdt(Nute(iz)+3/32*k1_dN+9/32*k2_dN,...
                                       Phyt(iz)+3/32*k1_dP+9/32*k2_dP,...
                                       Zoo(iz)+3/32*k1_dZ+9/32*k2_dZ, ...
                                zvec(iz),Vm, Ks, Kext,Rm, Lambda, gamma, m, g);
    [k4_dN, k4_dP, k4_dZ] = tau*dNPZdt(Nute(iz)+1932/2197*k1_dN+...
                                                -7200/2197*k2_dN+...
                                                7296/2197*k3_dN,...
                                       Phyt(iz)+1932/2197*k1_dP+...
                                                -7200/2197*k2_dP+...
                                                7296/2197*k3_dP,...
                                       Zoo(iz)+1932/2197*k1_dZ+...
                                                -7200/2197*k2_dZ+...
                                                7296/2197*k3_dZ,...
                                zvec(iz),Vm, Ks, Kext,Rm, Lambda, gamma, m, g);
    [k5_dN, k5_dP, k5_dZ] = tau*dNPZdt(Nute(iz)+439/216*k1_dN+...
                                                -8*k2_dN+...
                                                3680/513*k3_dN+...
                                                -845/4101*k4_dN,...
                                       Phyt(iz)+439/216*k1_dP+...
                                                -8*k2_dP+...
                                                3680/513*k3_dP+...
                                                -845/4101*k4_dP,...
                                       Zoo(iz)+439/216*k1_dZ+...
                                                -8*k2_dZ+...
                                                3680/513*k3_dZ+...
                                                -845/4101*k4_dZ,...
                                zvec(iz),Vm, Ks, Kext,Rm, Lambda, gamma, m, g);
    [k6_dN, k6_dP, k6_dZ] = tau*dNPZdt(Nute(iz)-8/27*k1_dN+...
                                                2*k2_dN+...
                                                -3544/2565*k3_dN+...
                                                1859/4104*k4_dN+...
                                                -11/40*k5_dN,...
                                         Phyt(iz)-8/27*k1_dP+...
                                                2*k2_dP+...
                                                -3544/2565*k3_dP+...
                                                1859/4104*k4_dP+...
                                                -11/40*k5_dP,...
                                        Zoo(iz)-8/27*k1_dZ+...
                                                2*k2_dZ+...
                                                -3544/2565*k3_dZ+...
                                                1859/4104*k4_dZ+...
                                                -11/40*k5_dZ,...
                                zvec(iz),Vm, Ks, Kext,Rm, Lambda, gamma, m, g);
    % Compute 4th order RK <- Method 1
    Nute_1(iz) = Nute(iz) + 25/216*k1_dN+1408/2565*k3_dN+2197/4104*k4_dN-1/5*k5_dN;
    Phyt_1(iz) = Phyt(iz) + 25/216*k1_dP+1408/2565*k3_dP+2197/4104*k4_dP-1/5*k5_dP;
    Zoo_1(iz) = Zoo(iz) + 25/216*k1_dZ+1408/2565*k3_dZ+2197/4104*k4_dZ-1/5*k5_dZ;
    % Compute 5th order RK <- Method 2
    Nute_2(iz) = Nute(iz) + 16/135*k1_dN+6656/12825*k3_dN+28561/56430*k4_dN-...
                                9/50*k5_dN+2/55*k6_dN;
    Phyt_2(iz) = Phyt(iz) + 16/135*k1_dP+6656/12825*k3_dP+28561/56430*k4_dP-...
                                9/50*k5_dP+2/55*k6_dP;
    Zoo_2(iz) = Zoo(iz) + 16/135*k1_dZ+6656/12825*k3_dZ+28561/56430*k4_dZ-...
                                9/50*k5_dZ+2/55*k6_dZ;
% Compute Error between Method 1 and Method 2 for each Nutrient
    Nute_e(zi) = abs(Nute_1(zi)-Nute_2(zi));
    Phyt_e(zi) = abs(Phyt_1(zi)-Phyt_2(zi));
    Zoo_e(zi) = abs(Zoo_1(zi)-Zoo_2(zi));
end